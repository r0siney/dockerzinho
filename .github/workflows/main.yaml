name: CI

on: [push]

jobs:
  dkr_linux:
    runs-on: ubuntu-latest
    steps:
    - name: docker
      run: |
        lscpu
  dkr_windows:
    runs-on: windows-latest
    steps:
      - name: check hyper v
        shell: pwsh
        run: |
          Get-ComputerInfo -property "HyperV*"
  # dkr_windows:
  #   runs-on: windows-latest
  #   steps:
  #   - uses: actions/checkout@v3
  #     with:
  #       fetch-depth: 2
  #   - name: docker
  #     run: |
  #       docker info
  #       # docker build -t test/windows .
  #       # docker run test/windows cmd.exe /s /c echo "ok windows"
  #       & 'C:\Program Files\Docker\Docker\DockerCli.exe' -SwitchDaemon
  #       docker info
  #       .\dockercli.exe -SwitchLinuxEngine
  #       docker run alpine apk --version
  dkr_macos:
    runs-on: macos-12
    steps:
    - name: docker
      run: |
        brew install docker-machine docker
        docker-machine create --virtualbox-cpu-count "2" --virtualbox-memory "1024" --virtualbox-disk-size "2000" --virtualbox-hostonly-cidr 192.168.56.1/21 default
        docker-machine env
        eval $(docker-machine env)
        export DOCKER_HOST_IP=`echo ${DOCKER_HOST} | cut -d '/' -f 3 | cut -d ':' -f 1`
        docker run --rm hello-world

  # dkr_macos:
  #   runs-on: macos-12
  #   steps:
  #   - run: |
  #       sysctl -a